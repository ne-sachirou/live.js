/*
 MIT License: live.js (2013-2013)ne_Sachirou <utakata.c4se@gmail.com>
*/
(function(w){function p(a){l=h;m=k;h=a.clientX+window.scrollX;k=a.clientY+window.scrollY}function f(a,b){var c;if(!(this instanceof f))return new f(a,b);if("string"===typeof b)return new q(a,b);b=b||document.body;b.bindings||x(b);if(c=r(b.bindings,function(b){return b.selector===a}))return c;this.selector=a;this.context=b;this.events=new g;this.namespaces={};b.bindings.push(this)}function x(a){a.bindings=[];n.forEach(function(b){a.addEventListener(b,function(c){y(b,c,a)},!1)})}function y(a,b,c){c.bindings.forEach(function(d){var e;
if(e=s(d.selector,b.target,c))if(a=z(e,a))t(d.events,a,b,d),Object.keys(d.namespaces).forEach(function(c){t(d.namespaces[c],a,b,d)})})}function z(a,b){var c,d,e;d=l;var f=m;e=h;var A=k;c=b.match(/^(pointer|mouse)(?:move|over|out)/i);if(!c)return b;d=u(a,d,f);e=u(a,e,A);return d&&e?c[1]+"move":!d&&e?c[1]+"over":d&&!e?c[1]+"out":null}function t(a,b,c,d){a[b].forEach(function(b){!1===b.call(d,c)&&(c.preventDefault(),c.stopPropagation())})}function q(a,b){var c=this;f.onload(b,function(b){B(b,c)});this.selector=
a;this.events=new g;this.namespaces={}}function B(a,b){var c=new f(b.selector,a);c.events.join(b.events);Object.keys(b.namespaces).forEach(function(a){c[a].join(b[a])})}function g(){var a=this;n.forEach(function(b){a[b]=[]})}function C(a,b){this.selector=a;this.callback=b}function D(a){return n.some(function(b){return b===a})}function s(a,b,c){c=c||document;return r(v(c.querySelectorAll(a)),function(a){return a===b})}function u(a,b,c){var d,e;a=a.getBoundingClientRect();d=a.left+window.scrollX;e=
a.top+window.scrollY;return d<=b&&b<d+a.width&&e<=c&&c<e+a.height}function v(a){var b,c,d=[];b=0;for(c=a.length;b<c;++b)d.push(a[b]);return d}function r(a,b){var c,d;c=0;for(d=a.length;c<d;++c)if(void 0!==a[c]&&b(a[c]))return a[c];return null}w.live=f;var n="pointerdown pointerup pointermove pointerover pointerout pointercancel pointerenter pointerleave keydown keyup keypress mousemove mouseover mouseout mousedown mouseup click dblclick".split(" "),l=0,m=0,h=0,k=0;document.body.addEventListener("pointermove",
p);document.body.addEventListener("pointerover",p);document.body.addEventListener("pointerout",function(a){h=l;k=m});f.onload=function(a,b,c){function d(b){v(b.addedNodes).forEach(function(b){b.tagName&&e(b)})}function e(a){b.onLoadBindings.forEach(function(c){s(c.selector,a,b)===a&&c.callback(a)})}var f;"function"===typeof b&&(c=b,b=document);b.onLoadBindings||(b.onLoadBindings=[],f=new MutationObserver(function(b){b.forEach(d)}),f.observe(b,{childList:!0,subtree:!0}));b.onLoadBindings.push(new C(a,
c))};f.prototype={on:function(a,b,c){var d=this;a=a.trim().toLowerCase();a=a.split(/\s+/);c?(this.namespaces[c]||(this.namespaces[c]=new g),a.forEach(function(a){d.namespaces[c][a].push(b)})):a.forEach(function(a){d.events[a].push(b)});return this},off:function(a,b){var c,d=this;if(!a&&!b)return this.events=new g,this.namespaces={},this;a=a.trim().toLowerCase();c=a.split(/\s+/);if(1===c.length&&D(c[0]))return void 0!==b?c.forEach(function(a){d.namespaces[b][a]=[]}):(this.events[a]=[],Object.keys(this.namespaces).forEach(function(a){c.forEach(function(b){d.namespaces[a][b]=
[]})})),this;b=a;this.namespaces[b]=new g;return this}};q.prototype={on:function(a,b,c){f.prototype.on.call(this,a,b,c);return this},off:function(a,b){f.prototype.off.call(this,a,callback,b);return this}};g.prototype={join:function(a){var b=this;Object.keys(this).forEach(function(c){b[c]=b[c].concat(a[c])});return this}}})(this);
